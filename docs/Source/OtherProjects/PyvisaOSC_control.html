

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SidePrj: Control MSOX2024a with pyvisa (2019) &mdash; Boyang Wang&#39;s Notebook</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon_logo.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SidePrj: Split Spectrum Processing Implementation with Python (2018)" href="SSP.html" />
    <link rel="prev" title="SidePrj: GRBL Python Library (2019)" href="GRBL_PythonLib.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/WebsiteLogo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../Resume/MyResume.html">Boyang Wang - Résumé</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#personal-details">PERSONAL DETAILS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#education">EDUCATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#research-interests">RESEARCH INTERESTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#skills">SKILLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#experience">EXPERIENCE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#research-assistant-illinois-institute-of-technology-2015-2020">Research Assistant Illinois Institute of Technology (2015-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#teaching-assistant-illinois-institute-of-technology-2015-2020">Teaching Assistant Illinois Institute of Technology (2015-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#research-student-argonne-national-laboratory-2017-2018">Research Student Argonne National Laboratory (2017-2018)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#research-projects">RESEARCH PROJECTS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#reconfigurable-ultrasonic-ndt-system-based-on-zynq-apsoc-2015-2019">Reconfigurable Ultrasonic NDT System based on ZYNQ APSoC (2015-2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#statistical-signal-analyzing-and-processing-based-on-artificial-intelligence-2016-2019">Statistical Signal Analyzing and Processing based on Artificial Intelligence  (2016-2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#data-compression-using-wavelet-packet-transform-optimized-by-convolutional-autoencoder-2020">Data Compression using Wavelet Packet Transform Optimized by Convolutional Autoencoder (2020)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#other-proejcts">OTHER PROEJCTS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#wearable-sensor-network-for-human-gesture-detection-based-on-artificial-intelligence-2019-2020">Wearable sensor network for human gesture detection based on Artificial Intelligence (2019-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/MyResume.html#a-single-camera-3d-microscope-detail-scanner-2019">A single Camera 3D microscope detail scanner (2019)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#awards">AWARDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#hobbies">HOBBIES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#certifications">CERTIFICATIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/MyResume.html#publications">PUBLICATIONS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html">王博杨 - 简历</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id2">联系方式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id3">教育背景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id4">科研方向</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id5">技术能力</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id6">工作经历</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id7">研究助理 伊利诺伊理工大学 (2015-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id8">助教 伊利诺伊理工大学 (2015-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id9">研究助理 美国阿贡国家实验室 (2017-2018)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id10">项目经历</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id11">基于可编程片上系统的超声波无损探伤系统设计 (2015-2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id12">基于神经网络的超声波无损探伤信号处理 (2016-2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id13">卷积自编码器用于优化基于小波包分解的超声波信号压缩 (2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id14">固态媒介中的超声波通讯 (2017-2020)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id15">其他课题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id16">基于神经网络和传感器网络的人类姿态检测 (2019-2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#d-2019">基于单通道显微镜相机的3D细节扫描仪 (2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id17">基于神经网络和单(双)通道腹膜心电图的胎儿心率检测 (2018)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id18">获奖情况</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id22">证书</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Resume/%E7%AE%80%E5%8E%86.html#id23">论文情况</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ResearchProjects/ResearchPrj.html">Research Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ResearchProjects/UltrasonicNDT.html">Ultrasonic NDT Signal Acquisition and Processing (USAP) System based on ZYNQ APSoC (2015-2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/UltrasonicNDT.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/UltrasonicNDT.html#system-implementation">System Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/UltrasonicNDT.html#example-result">Example Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/UltrasonicNDT.html#publications">PUBLICATIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ResearchProjects/UltrasondComm.html">Software Defined Ultrasonic Communication System based on ZYNQ SoC (2017-2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/UltrasondComm.html#publications">PUBLICATIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ResearchProjects/SignalProcessingAI.html">Statistical Signal Analyzing and Processing based on Artificial Intelligence (2016-2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/flawnn.html">Ultrasonic Flaw Detection based on Temporal and Subband Signals Applied to Neural Network (2017-2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/grainsize.html">Multilayer Perceptron Neural Networks for Grain Size Estimation and Classification (2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/fecg.html">FECG and MECG charachterization using machine learning (2018)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ResearchProjects/fecg.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ResearchProjects/fecg.html#training-the-neural-network-with-tensorflow">Training the Neural Network with Tensorflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ResearchProjects/fecg.html#result">Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ResearchProjects/fecg.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ResearchProjects/SignalProcessingAI.html#publications">PUBLICATIONS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CoursePrj/CoursePrj.html">Course Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE425.html">ECE425 Analysis and Design of Analog IC - Operational Amplifier Design (Fall2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#calculations">Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#schematics-and-simulations">Schematics and Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#schematic-setup">Schematic Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#bode-plot-dc-gain-unity-gain-frequency-gain-margin">Bode Plot (DC gain &amp; Unity Gain Frequency &amp; Gain Margin)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#phase-margin-test">Phase Margin Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#slew-rate-test">Slew Rate Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#input-offset-voltage">Input offset Voltage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#input-common-mode-range">Input Common Mode Range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#output-swing">Output swing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#openloop-response">Openloop response</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#performance-evaluation">Performance evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#openloop-gain">Openloop Gain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#slew-rate">Slew Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#icmr">ICMR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#id1">Output swing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE425.html#power-consumption">Power Consumption</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#conclusion">Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE425.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE565.html">ECE565 Nodule Detection based on Statistical Signal Analysis (Spring2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE565.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE565.html#methods-and-results">Methods and Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE565.html#step-1-segmentation-of-the-lungs">Step 1: Segmentation of the lungs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE565.html#step-2-detection-and-segmentation-of-lesion-candidates">Step 2: Detection and segmentation of lesion candidates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE565.html#step-3-connectivity-analysis-and-feature-extraction-from-the-segmented-lesion-candidates">Step 3: Connectivity analysis and feature extraction from the segmented lesion candidates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE565.html#step-4-feature-selection-and-classification-of-the-lesion-candidates-by-using-a-rule-based-scheme">Step 4: Feature selection and classification of the lesion candidates by using a rule based scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE565.html#discussion-and-conclusion">Discussion and Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE565.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE584.html">ECE584 DCT Implementation Optimization on VLSI level (Spring2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#background">Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#implementation">Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE584.html#dct-direct-implementation-with-algorithm-strength-reduction">DCT direct implementation with Algorithm Strength Reduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE584.html#bindct-multiplier-less-dct-implementation">binDCT multiplier-less DCT implementation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#functional-validation-and-verification">Functional Validation and verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#matlab-ise-co-simulation">MATLAB ISE co-simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#result">Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#conclusion-and-future-work">Conclusion and Future Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE584.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE529.html">ECE529 Advanced VLSI Systems Design (Spring2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#background">Background</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#multiplier">multiplier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#conventional-domino-technique">Conventional Domino Technique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#split-path-data-driven-dynamic-logic">Split Path Data Driven Dynamic Logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#architecture-exploration">Architecture Exploration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#function-validation-and-verification">Function Validation and Verification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#dual-rail-domino-adder-design">Dual rail DOMINO adder design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#id2">Split Path Data Driven Dynamic Logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#bonus">Bonus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#power-gating-of-the-dual-rail-domino-design">Power gating of the Dual rail DOMINO design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#power-gating-of-the-split-path-data-driven-dynamic-logic-design">Power gating of the Split Path Data Driven Dynamic Logic design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE529.html#comparison-of-these-two-designs">Comparison of these two designs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#conclusion-and-future-work">Conclusion and Future Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE529.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE429.html">ECE429 Intro to VLSI (Fall2013)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE429.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE429.html#background-knowledge">Background Knowledge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE429.html#implementation-and-simulation">implementation and Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE429.html#carry-ripple-adder">Carry Ripple Adder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE429.html#carry-skip-adder">Carry Skip Adder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE429.html#carry-select-adder">Carry Select Adder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE429.html#prefix-adder-koggle-stone">Prefix Adder: Koggle Stone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CoursePrj/ECE429.html#bonus-multiplier">bonus: multiplier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE429.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE587.html">ECE587 Hardware/Software Codesign (Fall2013)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#background-knowledge">Background Knowledge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#d-noc-architecture">2D NoC Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#system-implementation">System Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#system-evaluation">System Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#conclusion">Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CoursePrj/ECE587.html#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../CoursePrj/ECE441.html">ECE441 Microcomputers and Embedded Computing Systems (Spring2013)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="OtherPrj.html">Other Projects</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GRBL_PythonLib.html">SidePrj: GRBL Python Library (2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="GRBL_PythonLib.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="GRBL_PythonLib.html#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SidePrj: Control MSOX2024a with pyvisa (2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-environment-setup">System Environment Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation">Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SSP.html">SidePrj: Split Spectrum Processing Implementation with Python (2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SSP.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="SSP.html#implementation">Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="SSP.html#results">Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CheckeeCrawl.html">checkee.info data Crawl and Analysis (2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CheckeeCrawl.html#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="CheckeeCrawl.html#update-on-july-2019">update on July 2019:</a></li>
<li class="toctree-l4"><a class="reference internal" href="CheckeeCrawl.html#update-on-march-2020">update on March 2020:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="CheckeeCrawl.html#implementation">Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="CheckeeCrawl.html#example-results">Example Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="CheckeeCrawl.html#disclaimer">Disclaimer:</a></li>
<li class="toctree-l3"><a class="reference internal" href="CheckeeCrawl.html#note">Note:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="NEXYS4DDR-OV7640.html">WeekendPrj: Adapting OV7670 camera module with Nexys4 DDR board (2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="NEXYS4DDR-OV7640.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEXYS4DDR-OV7640.html#camera-interface">Camera Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEXYS4DDR-OV7640.html#vivado-ip-integrator">Vivado IP-Integrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEXYS4DDR-OV7640.html#result">Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="RGBPannel.html">WeekendPrj: 32by16 RGB Panel Control with ZYNQ APSoC(2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#led-panel-design-fpga-code-to-drive-it">LED Panel Design &amp; FPGA code to drive it</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#top-level-fpga-block-diagram">Top Level FPGA Block Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#write-software-in-xsdk">Write Software in XSDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#test-results">Test Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#project-expansion">Project Expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#to-duplicate-the-design">To duplicate the design</a></li>
<li class="toctree-l3"><a class="reference internal" href="RGBPannel.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../StudentPrj/StudentPrj.html">Supervised Students’ Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../StudentPrj/FRNN.html">Faster R-CNN Applied to Ultrasonic Images for Breast Lesion Detection and Classification (2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/FRNN.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/FRNN.html#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/FRNN.html#publication">publication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../StudentPrj/DetailScanner.html">A Single-Camera 3D Microscope Scanner with Image Stitching and Stereo Matching (2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/DetailScanner.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/DetailScanner.html#system-implementation">System Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/DetailScanner.html#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/DetailScanner.html#publication">publication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../StudentPrj/zynqvideoproc.html">ZYNQ APSoC based real-time HDMI Video Processing (2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/zynqvideoproc.html#poster1">Poster1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/zynqvideoproc.html#poster2">Poster2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../StudentPrj/zynq_audio.html">Audio Signal Subband Decomposition and Reconstruction using ZYNQ APSoC (2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../StudentPrj/zynq_audio.html#poster">Poster</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CertificationsAwards/awards.html">Awards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/awards.html#sigma-xi-iit-student-award-for-excellence-in-university-research-2020">Sigma Xi/IIT Student Award for Excellence in University Research (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/awards.html#student-paper-competition-winner-in-the-2019-ieee-international-ultrasonics-symposium-2019">Student Paper Competition Winner in the 2019 IEEE International Ultrasonics Symposium (2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/awards.html#excellence-award-in-field-rank-students-science-and-technology-innovation-project-2011">Excellence Award in Field Rank Students’ Science And Technology Innovation Project (2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/awards.html#first-prize-in-beijing-college-students-physical-experimental-contest-2010">First prize in Beijing college students’ Physical Experimental Contest (2010)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CertificationsAwards/certifications.html">Certifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/certifications.html#deeplearning-ai-tensorflow-developer">DeepLearning.AI TensorFlow Developer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/certifications.html#machine-learning">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CertificationsAwards/certifications.html#algorithms">Algorithms</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BoyangWangPersonalSite</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="OtherPrj.html">Other Projects</a> &raquo;</li>
        
      <li>SidePrj: Control MSOX2024a with pyvisa (2019)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="SSP.html" class="btn btn-neutral float-right" title="SidePrj: Split Spectrum Processing Implementation with Python (2018)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="GRBL_PythonLib.html" class="btn btn-neutral float-left" title="SidePrj: GRBL Python Library (2019)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="sideprj-control-msox2024a-with-pyvisa-2019">
<h1>SidePrj: Control MSOX2024a with pyvisa (2019)<a class="headerlink" href="#sideprj-control-msox2024a-with-pyvisa-2019" title="Permalink to this headline">¶</a></h1>
<p>This project serves as one of the components of my research project: <a class="reference internal" href="#ultrasonic-ndt-signal-acquisition-and-processing-system-based-on-zynq-apsoc">Ultrasonic NDT Signal Acquisition and Processing System based on ZYNQ APSoC</a>. MSOX series oscilloscopes from keysight allow multiple connection methods (Ethernet, USB, GPIB, etc.) with one universal interface called VISA. Thanks to the python library <strong>Pyvisa</strong>, we are able to connect to our oscilloscope on any platform, any operating systems with python. This is the most convenient and affordable solution I can find up to now.</p>
<p><strong>Pyvisa</strong> is a python package that allows us to control all kinds of measurement devices without bothered by different interfaces (such as USB, Ethernet, GPIB). I need it for acquiring data from the Ultrasonic NDT experimental platform. <strong>MSOX2024A</strong> is used in the testsetup. This is a keysight <strong>InfiniiVision</strong> oscilloscope with <strong>200 MHz bandwidth</strong> and up to <strong>2 GSPS sample rate</strong>.</p>
<div class="section" id="system-environment-setup">
<span id="ultrasonic-ndt-signal-acquisition-and-processing-system-based-on-zynq-apsoc"></span><h2>System Environment Setup<a class="headerlink" href="#system-environment-setup" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.keysight.com/main/software.jspx?ckey=2175637&amp;lc=eng&amp;cc=US&amp;nid=-33330.977662&amp;id=2175637&amp;pageMode=CV">KeySight IO Library Suilte 2019</a> is the official supported software for Keysight Devices on Windows operating systems. It contains all the necessary libraries to get your device working on Windows system. Which means you don’t have to collected all pieces of software components to enable VISA interface.</p>
<p><strong>Anaconda</strong> is a very powerful and useful python environment on all platforms. It allows me to maintain a Python environment independent with my system python environment. It reduce the risk of messing up the system env especially when you are first to python. And with its powerful library collection, it makes development much easier. Pyvisa can be installed in Anaconda using the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">pyvisa</span>
</pre></div>
</div>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>Originally, I was planning to build the python library for MSOX2024A. However, I found that the work is too much for one person within a few days. I decided to go with some specific functionalities that are crucial for my experiments. I created an class in python called MSOX2024A and created a few methods to accomplish the task I need to do. Here listed a few important methods for the Oscilloscope Control and Signal Acquisition.</p>
<p>In Pyvisa, all the devices are managed using the <code class="docutils literal notranslate"><span class="pre">resource</span> <span class="pre">manager</span></code> object. The following function will return a list of available devices VISA addresses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">GetResoureList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">resource</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rm</span><span class="o">.</span><span class="n">list_resources</span><span class="p">())</span>
    <span class="n">resource</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">resource</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>I created a <code class="docutils literal notranslate"><span class="pre">msox2024a</span></code> object for the oscilloscope device I have, the object is defined as follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">msox2024a</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Resource_Manager</span><span class="p">,</span> <span class="n">SCOPE_VISA_ADDRESS</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rm</span> <span class="o">=</span> <span class="n">Resource_Manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectstatus</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visa_address</span> <span class="o">=</span> <span class="n">SCOPE_VISA_ADDRESS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NUMBER_ANALOG_CHS</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channelstatus</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waveformstatus</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triggerstatus</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timebasestatus</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CHS_ON</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ANALOGVERTPRES</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NUMBER_OF_POINTS_TO_ACTUALLY_RETRIEVE</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NUMBER_CHANNELS_ON</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TOTAL_BYTES_TO_XFER</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACQ_TYPE</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Connect, Disconnect, reset, AutoScale are the most fundamental methods of the object <code class="docutils literal notranslate"><span class="pre">msox2024a</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectstatus</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rm</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Unable to connect to oscilloscope at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_address</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully Connected to Device&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">10000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectstatus</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device already connected&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span>

<span class="k">def</span> <span class="nf">Disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectstatus</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectstatus</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device Successfully Disconnected&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device not Connected&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">Reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*RST&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">AutoScale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;:AUToscale&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following functions reports the connection status:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">queryIDN</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">IDN</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;*IDN?&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="n">IDN</span> <span class="o">=</span> <span class="n">IDN</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">IDN</span>

<span class="k">def</span> <span class="nf">queryOPT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">OPT</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;*OPT?&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="n">OPT</span> <span class="o">=</span> <span class="n">OPT</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">OPT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>The following code query and config the channel configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">queryChannelStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">option</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BANDwidth&quot;</span><span class="p">,</span><span class="s2">&quot;BWLimit&quot;</span><span class="p">,</span><span class="s2">&quot;COUPling&quot;</span><span class="p">,</span><span class="s2">&quot;DISPlay&quot;</span><span class="p">,</span><span class="s2">&quot;IMPedance&quot;</span><span class="p">,</span><span class="s2">&quot;INVert&quot;</span><span class="p">,</span><span class="s2">&quot;LABel&quot;</span><span class="p">,</span>
              <span class="s2">&quot;OFFSet&quot;</span><span class="p">,</span><span class="s2">&quot;PROBe&quot;</span><span class="p">,</span><span class="s2">&quot;PROTection&quot;</span><span class="p">,</span><span class="s2">&quot;RANGe&quot;</span><span class="p">,</span><span class="s2">&quot;SCALe&quot;</span><span class="p">,</span><span class="s2">&quot;UNITs&quot;</span><span class="p">,</span><span class="s2">&quot;VERNier&quot;</span><span class="p">]</span>
    <span class="n">channelstatus</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">items</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span>
        <span class="n">channelstatus</span><span class="p">[</span><span class="n">items</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">channels</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NUMBER_ANALOG_CHS</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">channelstatus</span><span class="p">[</span><span class="n">items</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;:CHANnel&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channelstatus</span> <span class="o">=</span> <span class="n">channelstatus</span>
    <span class="k">return</span> <span class="n">channelstatus</span>

<span class="k">def</span> <span class="nf">configChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">channelstatus</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BANDwidth&quot;</span><span class="p">,</span><span class="s2">&quot;BWLimit&quot;</span><span class="p">,</span><span class="s2">&quot;COUPling&quot;</span><span class="p">,</span><span class="s2">&quot;DISPlay&quot;</span><span class="p">,</span><span class="s2">&quot;IMPedance&quot;</span><span class="p">,</span><span class="s2">&quot;INVert&quot;</span><span class="p">,</span><span class="s2">&quot;LABel&quot;</span><span class="p">,</span>
              <span class="s2">&quot;OFFSet&quot;</span><span class="p">,</span><span class="s2">&quot;PROBe&quot;</span><span class="p">,</span><span class="s2">&quot;RANGe&quot;</span><span class="p">,</span><span class="s2">&quot;SCALe&quot;</span><span class="p">,</span><span class="s2">&quot;UNITs&quot;</span><span class="p">,</span><span class="s2">&quot;VERNier&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">channelstatus</span><span class="p">[</span><span class="n">items</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">channels</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="c1">#print(&quot;:CHANnel&quot; + str(channels+1)+&quot;:&quot;+items + &quot; &quot; + status[channels])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">osc_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;:CHANnel&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channels</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="n">items</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">status</span><span class="p">[</span><span class="n">channels</span><span class="p">])</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>I am not going to list all functions for this project, the concept is very clear here, you only need to implement the functions according to the oscilloscope programmer’s guide. During the communication, I do notice some miscellaneous error which is also reported in this <a class="reference external" href="https://github.com/pyvisa/pyvisa/issues/376">thread</a>. This issue is resolved when I changed the connection mode to compatible mode.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference external" href="https://www.keysight.com/upload/cmc_upload/All/2000_series_prog_guide.pdf">Keysight InfiniiVision 2000 X-Series Oscilloscopes Programmer’s Guide</a></p></li>
<li><p><a class="reference external" href="https://pyvisa.readthedocs.io/en/master/">Pyvisa Documentation</a></p></li>
</ol>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, BoyangWang

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>